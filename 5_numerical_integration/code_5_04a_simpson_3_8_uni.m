% Code 5-4a | Simpson 3/8 rule (uniform; 3K+1 grid)
clc; clear
X = [0, 1/3, 2/3, 1, 4/3, 5/3, 2];  %uniform 3K+1, K>=1
F = sqrt(4-X.^2);
%Method_________________________________________________________________
n = numel(X); h = (X(n)-X(1))/(n-1);  m = (n-1)/3;
S = 3/8*h*[1 repmat([3,3,2],[1,m-1]) 3 3 1];
I = S*F(:);
%Illustration___________________________________________________________
fprintf('----------------\n');
fprintf('%s%12.5g\n','I = ',I);
fprintf('----------------\n');
